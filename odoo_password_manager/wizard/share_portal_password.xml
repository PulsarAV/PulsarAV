<?xml version="1.0"?>
<odoo>

    <record id="share_portal_password_wizard_form_view"  model="ir.ui.view">
        <field name="name">share.portal.password.form.view</field>
        <field name="model">share.portal.password</field>
        <field name="arch" type="xml">
            <form>
                <group>
                    <field name="password_ids" widget="many2many_tags" invisible="1"/>
                    <field name="bundle_id" invisible="1"/>
                    <field name="vault_method"/>
                    <field name="vault_id"
                           domain="[('bundle_id', '=', bundle_id)]"
                           invisible="vault_method != 'existing_vault'"
                           required="vault_method == 'existing_vault'"
                    />
                </group>
                <group invisible="vault_method != 'new_vault'">
                    <group>
                        <field name="name" required="vault_method == 'new_vault'"/>
                        <field name="password" widget="PasswordCopy" password="True" required="vault_method == 'new_vault'"/>
                        <field name="confirm_password" class="oe_edit_only" password="True" required="vault_method == 'new_vault'"/>
                    </group>
                    <group>
                        <field name="valid_until"/>
                        <field name="session_length"/>
                        <field name="description"/>
                    </group>
                </group>
                <group string="Contacts" required="vault_method != 'new_vault'">
                    <field name="partner_ids" widget="many2many_tags" options="{'no_create_edit': 1, 'no_quick_create': 1}"/>
                    <field name="send_invitation" invisible="vault_method != 'new_vault' or partner_ids == []"/>
                    <div class="text-muted" colspan="2" invisible="vault_method != 'new_vault' or partner_ids == []">
                        To observe password vaults, a contact should also be also granted portal access. You can give such rights on a partner form.
                    </div>
                </group>
            </form>
        </field>
    </record>
    <record id="share_portal_password_action" model="ir.actions.act_window">
         <field name="name">Share in portal</field>
         <field name="type">ir.actions.act_window</field>
         <field name="res_model">share.portal.password</field>
         <field name="view_mode">form</field>
         <field name="view_id" ref="odoo_password_manager.share_portal_password_wizard_form_view"/>
         <field name="target">new</field>
    </record>

</odoo>
